{"version":3,"sources":["views/app-views/home/main/planner/index.js"],"names":["ENTITIES","id","name","img","DrawComponent","ref","useRef","selected","setSelected","useState","target","setTarget","elements","setElements","x","y","handlerMoveMouse","useCallback","e","rect","current","getBoundingClientRect","prev","map","element","index","clientX","left","clientY","top","useEffect","_ref","addEventListener","removeEventListener","_jsxs","className","children","_jsx","Flex","entity","Card","flexDirection","width","height","src","alt","Button","onClick","style","border","filter","_","i","Upload","accept","showUploadList","onChange","file","originFileObj","reader","FileReader","readAsText","onload","JSON","parse","result","onerror","console","log","error","el","File","stringify","type","fileName","document","createElement","setAttribute","textContent","display","body","appendChild","click","removeChild","triggerDownload","window","URL","createObjectURL","_ENTITIES$find","draggable","find","backgroundColor","onMouseDown","onMouseUp"],"mappings":"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","file":"static/js/10.fcd91d01.chunk.js","sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport \"./style.css\";\nimport { Button, Card, Upload } from \"antd\";\nimport Flex from \"components/shared-components/Flex\";\n\nconst ENTITIES = [\n  {\n    id: 0,\n    name: \"Стол\",\n    img: \"https://idei.club/raznoe/uploads/posts/2023-05/1685343702_idei-club-p-obedennii-stol-vid-sverkhu-dizain-vkontakt-31.png\",\n  },\n  {\n    id: 1,\n    name: \"Стул\",\n    img: \"https://cdn-icons-png.flaticon.com/512/1678/1678872.png\",\n  },\n];\n\nconst DrawComponent = () => {\n  const ref = useRef();\n  const [selected, setSelected] = useState(null);\n  const [target, setTarget] = useState(null);\n  const [elements, setElements] = useState([\n    { id: 0, x: 120, y: 80 },\n    { id: 1, x: 140, y: 60 },\n  ]);\n\n  const handlerMoveMouse = useCallback(\n    (e) => {\n      const rect = ref.current.getBoundingClientRect();\n      if (target === null) return;\n      setElements((prev) => [\n        ...prev.map((element, index) => {\n          if (index === target) {\n            return {\n              ...element,\n              x: e.clientX - rect.left - 50,\n              y: e.clientY - rect.top - 50,\n            };\n          }\n          return element;\n        }),\n      ]);\n    },\n    [target]\n  );\n\n  function triggerDownload(fileName) {\n    var element = document.createElement(\"a\");\n    element.setAttribute(\"href\", fileName);\n    element.setAttribute(\"download\", \"plan.txt\");\n    element.textContent = \"asd\";\n    element.style.display = \"none\";\n    document.body.appendChild(element);\n    element.click();\n    document.body.removeChild(element);\n  }\n\n  useEffect(() => {\n    const _ref = ref.current;\n    _ref.addEventListener(\"mousemove\", handlerMoveMouse);\n    return () => {\n      _ref.removeEventListener(\"mousemove\", handlerMoveMouse);\n    };\n  }, [handlerMoveMouse]);\n\n  return (\n    <div className=\"planner\">\n      <div className=\"planner_controls\">\n        <Flex>\n          {ENTITIES.map((entity) => (\n            <Card key={entity.id}>\n              <Flex flexDirection=\"column\">\n                <img width={100} height={100} src={entity.img} alt=\"\" />\n                <br />\n                <Button\n                  onClick={() =>\n                    setElements([...elements, { id: entity.id, x: 0, y: 0 }])\n                  }\n                >\n                  Добавить\n                </Button>\n              </Flex>\n            </Card>\n          ))}\n        </Flex>\n\n        <div className=\"planner_coordinates-list\">\n          {elements.map((element, index) => (\n            <div\n              key={index}\n              onClick={() => setSelected(index)}\n              className=\"planner_coordinates-item\"\n              style={{\n                border:\n                  index === selected ? \"1px solid gray\" : \"1px solid white\",\n              }}\n            >\n              <div className=\"planner_coordinate-item\">x: {element.x}</div>\n              <div className=\"planner_coordinate-item\">y: {element.y}</div>\n              <Button\n                onClick={() =>\n                  setElements(elements.filter((_, i) => i !== index))\n                }\n              >\n                Удалить\n              </Button>\n            </div>\n          ))}\n        </div>\n        <div className=\"planner_import-export\">\n          <Upload\n            accept=\"text/plain\"\n            showUploadList={false}\n            onChange={(e) => {\n              let file = e.file.originFileObj;\n              let reader = new FileReader();\n              reader.readAsText(file);\n\n              reader.onload = () => {\n                setElements(JSON.parse(reader.result));\n              };\n\n              reader.onerror = () => {\n                console.log(reader.error);\n              };\n            }}\n          >\n            <Button>Загрузить</Button>\n          </Upload>\n          <Button\n            onClick={() => {\n              let el = new File([JSON.stringify(elements)], \"draw.txt\", {\n                type: \"text/plain\",\n              });\n              var url = window.URL.createObjectURL(el);\n              triggerDownload(url);\n            }}\n          >\n            Сохранить\n          </Button>\n        </div>\n      </div>\n\n      <div ref={ref} className=\"planner_draw-container\">\n        {elements.map((element, index) => (\n          <img\n            draggable={false}\n            src={ENTITIES.find((entity) => entity.id === element.id)?.img}\n            alt=\"\"\n            key={index}\n            id={index}\n            className=\"planner_image\"\n            style={{\n              left: element.x,\n              top: element.y,\n              backgroundColor: index === selected ? \"gray\" : \"white\",\n            }}\n            onMouseDown={() => {\n              setTarget(index);\n              setSelected(index);\n            }}\n            onMouseUp={() => setTarget(null)}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default DrawComponent;\n"],"sourceRoot":""}